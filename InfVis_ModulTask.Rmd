---
title: "InfVis Modul Task"
author: "Bal√°zs Dukai"
date: "01.04.2015"
output: pdf_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
summary(cars)
```

You can also embed plots, for example:

```{r, echo=FALSE}
plot(cars)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

```{r}
library(ggplot2)
source("HM_year.R")
```

The first line will take a few seconds!
```{r}
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
attach(NEI)
attach(SCC)
```

Calculate the harmonic mean per year
```{r}
NEI_HM <- data.frame(year = unique(NEI$year), HM = HM_year(NEI))
year <- unique(NEI$year)
```

And the plot:
```{r, echo=F}
qplot(data=NEI_HM, x=year, y=HM, xlim=c(1999,2008), geom="path") + 
    geom_point(shape=1, colour="Red") + 
    geom_text(aes(label=round(NEI_HM$HM, digits=2)), hjust=-0.3, vjust=-0.4, 
    size=4, colour="Red") + 
    labs(x="Year", y="Harmonic mean") + scale_x_continuous(breaks=year)
```

